#include <stdio.h>
#include <stdlib.h>

void ordena(float*vetor, int tam){

    if(tam<=1){
        return;
    }
    else{
    float x = vetor[0];
    int a = 1;
    int b = tam-1;

    do {
        while(a<tam && vetor[a]<=x)a++;
        while (vetor[b]>x)b--;
        if(a<b){
            float temp=vetor[a];
            vetor[a]=vetor[b];
            vetor[b]=temp;
            a++;b--;
        }
    } while(a<=b);
    vetor[0] = vetor[b];
    vetor[b] = x;

    ordena(vetor,b);
    ordena(&vetor[a],tam-a);
    }

}

int main(){
    int cont=0,i;
    float n;
    FILE*file = fopen("numeros.txt","r");
    if (file==NULL)exit(1);
  
    while(fscanf(file,"%f",&n)==1) {
        cont++;
    }
    rewind(file);
    float *vet = (float*)malloc(cont * sizeof(float));
    if (vet == NULL)exit(1);

    for (i=0;i<cont;i++){
    if(fscanf(file,"%f",&vet[i])!=1){ 
        printf("error: arquivo<vetor");
        break;
    }
    }
    fclose(file);
    ordena(vet,cont);

    FILE*binfile = fopen("numeros.bin","wb");
    if(binfile==NULL)exit(1);
    fwrite(vet,sizeof(float),cont,binfile);

    fclose(binfile);

    binfile = fopen("numeros.bin", "rb");
    if (binfile != NULL) {
        float verifica[cont];
        fread(verifica, sizeof(float), cont, binfile);
        fclose(binfile);

        printf("Verificacao binaria: ");
        for (i = 0; i < cont; i++) {
            printf("%.2f ", verifica[i]);
        }
        printf("\n");
    }

    free(vet);
    return 0;
}
